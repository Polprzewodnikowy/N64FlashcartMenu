[Return to the index](./00_index.md)
## Developer Guide

You can use a dev container in VSCode to ease development.

Expected pre-requsites:
* Docker container environment (for dev container support).
* VSCode.

### A quick start video tutorial on how to set up your environment
[![Devcontainer quick start guide](http://img.youtube.com/vi/h05ufOsRgZU/0.jpg)](http://www.youtube.com/watch?v=h05ufOsRgZU "Devcontainer quick start guide").


### How to deploy
#### SC64
* Download the deployer [here](https://github.com/Polprzewodnikowy/SummerCart64/releases/download/v2.20.0/sc64-deployer-windows-v2.20.0.zip).
* Extract and place `sc64deployer.exe` in the `tools/sc64` directory.

Make sure that your firmware is compatible (currently v2.20.0+).
See: [here](https://github.com/Polprzewodnikowy/SummerCart64/blob/v2.20.0/docs/00_quick_startup_guide.md#firmware-backupupdate)

##### From the devcontainer
It is not currently possible to directly communicate with USB devices. BUT, you can use a proxy TCP/IP connection as a workaround.  
To set up a proxy, open a terminal window, `cd ./tools/sc64` and then `./sc64deployer.exe server`.

Then, in the dev container, use `make run` or `make run-debug`.


##### From your host (Windows) OS

* Run `./localdeploy.bat` from the terminal.

Toggle the N64 POWER switch to load the ROM.

`ms-vscode.makefile-tools` will help (installed automatically in dev container).  
NOTE: it does not yet work with `F5`: see [this blog post](https://devblogs.microsoft.com/cppblog/now-announcing-makefile-support-in-visual-studio-code/).  
WORKAROUND: in the dev container terminal, use make directly, i.e.: `make`.  
The ROM can be found in the `output` directory.

NOTE: A "release" version of the SC64 menu is called `sc64menu.n64` and can be generated by running `make all` or running `make sc64`. You can then copy the resulting `sc64menu.n64` file to your SD card.

#### Ares Emulator
For ease of development and debugging, the N64FlashcartMenu ROM can run in the [Ares emulator](https://ares-emu.net/) (without most flashcart features).

* Ensure you have the Ares emulator on your computer.
* Load the `N64FlashcartMenu.n64` ROM.

#### Others
* Add the required file to the correct folder on your SD card.


## Update submodules
To update to the latest version, use `git submodule update --remote` from the terminal.

### libdragon
This repo currently uses the `preview` branch as a submodule at a specific commit.
* To ensure your local instance is building against it, use `cd ./libdragon && make clobber -j && make libdragon tools -j && make install tools-install -j && cd ..`

## Generate documentation
Run `doxygen` from the dev container terminal. Make sure you fix the warnings before creating a PR!  
Generated documentation is located in the `output/docs` folder and auto-published to the `gh-pages` branch when merged with `main`.

Once merged, they can be viewed [here](https://polprzewodnikowy.github.io/N64FlashcartMenu/).

### Test generated docs in the dev-container
Testing the documentation locally allows you to preview changes and ensure everything renders correctly before submitting your changes.

Install Prerequisites:
```bash
apt-get install ruby-full build-essential zlib1g-dev
gem install jekyll bundler
```

You can then serve the webpage:
```bash
cd output/docs && jekyll serve
```
